<group name="ftp,vsftpd,authentication,access">

    <!-- ========================= -->
    <!--  FTP: Intentos fallidos   -->
    <!-- ========================= -->
    <rule id="83050" level="3">
        <field name="program">vsftpd</field>
        <match>FAIL LOGIN</match>
        <description>FTP: Intento de login fallido.</description>
    </rule>

    <!-- Agrupación de fallos repetidos (bruteforce básica) -->
    <rule id="83051" level="7" frequency="5" timeframe="30">
        <if_sid>83050</if_sid>
        <same_source_ip />
        <description>FTP: Posible ataque de fuerza bruta (múltiples fallos).</description>
    </rule>


    <!-- ========================= -->
    <!--  FTP: Logins exitosos     -->
    <!-- ========================= -->
    <rule id="83052" level="3">
        <field name="program">vsftpd</field>
        <match>LOGIN OK</match>
        <description>FTP: Login FTP exitoso.</description>
    </rule>

    <!-- Login exitoso después de varios fallos -->
    <rule id="83053" level="10">
        <if_sid>83051</if_sid>
        <match>LOGIN OK</match>
        <description>FTP: Login exitoso tras múltiples intentos fallidos.</description>
    </rule>


    <!-- ========================= -->
    <!--  FTP: Subida de archivos  -->
    <!-- ========================= -->
    <rule id="83054" level="5">
        <field name="program">vsftpd</field>
        <match>UPLOAD:</match>
        <description>FTP: Archivo subido al servidor.</description>
    </rule>

    <!-- Subida de archivo ejecutable o sospechoso -->
    <rule id="83055" level="8">
        <if_sid>83054</if_sid>
        <regex>\.sh$|\.php$|\.py$|\.exe$|\.bat$|\.pl$|\.cgi$</regex>
        <description>FTP: Subida de archivo potencialmente malicioso.</description>
    </rule>


    <!-- ========================= -->
    <!--  FTP: Descarga de archivos -->
    <!-- ========================= -->
    <rule id="83056" level="3">
        <field name="program">vsftpd</field>
        <match>DOWNLOAD:</match>
        <description>FTP: Archivo descargado desde el servidor.</description>
    </rule>


    <!-- ========================= -->
    <!--  FTP: Eliminación de archivos -->
    <!-- ========================= -->
    <rule id="83057" level="6">
        <field name="program">vsftpd</field>
        <match>DELE</match>
        <description>FTP: Eliminación de archivos detectada.</description>
    </rule>

    <!-- Eliminación masiva de archivos -->
    <rule id="83058" level="7" frequency="5" timeframe="30">
        <if_sid>83057</if_sid>
        <same_source_ip />
        <description>FTP: Eliminación masiva de archivos (actividad sospechosa).</description>
    </rule>

</group>

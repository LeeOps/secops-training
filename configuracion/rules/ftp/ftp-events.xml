<group name="ftp,vsftpd,authentication,access">

    <!-- Intentos fallidos -->
    <rule id="83000" level="3">
        <field name="program">vsftpd</field>
        <match>FAIL LOGIN</match>
        <description>FTP: Intento de login fallido.</description>
    </rule>

    <!-- Bruteforce (fallos repetidos) -->
    <rule id="83001" level="7" frequency="5" timeframe="30">
        <if_sid>83000</if_sid>
        <same_source_ip />
        <description>FTP: Posible fuerza bruta.</description>
    </rule>

    <!-- Login correcto -->
    <rule id="83010" level="3">
        <field name="program">vsftpd</field>
        <match>LOGIN OK</match>
        <description>FTP: Login exitoso.</description>
    </rule>

    <!-- Login correcto tras bruteforce -->
    <rule id="83011" level="10">
        <if_sid>83001</if_sid>
        <match>LOGIN OK</match>
        <description>FTP: Login exitoso tras intentos fallidos.</description>
    </rule>

    <!-- Subida de archivos -->
    <rule id="83020" level="5">
        <field name="program">vsftpd</field>
        <match>UPLOAD:</match>
        <description>FTP: Archivo subido al servidor.</description>
    </rule>

    <!-- Subida de archivos sospechosos -->
    <rule id="83021" level="8">
        <if_sid>83020</if_sid>
        <regex>\.sh$|\.php$|\.py$|\.exe$|\.bat$|\.pl$|\.cgi$</regex>
        <description>FTP: Subida de archivo potencialmente malicioso.</description>
    </rule>

    <!-- Descarga de archivos -->
    <rule id="83030" level="3">
        <field name="program">vsftpd</field>
        <match>DOWNLOAD:</match>
        <description>FTP: Archivo descargado.</description>
    </rule>

    <!-- Eliminaciones -->
    <rule id="83040" level="6">
        <field name="program">vsftpd</field>
        <match>DELE</match>
        <description>FTP: Eliminación de archivos.</description>
    </rule>

    <!-- Eliminaciones masivas -->
    <rule id="83041" level="7" frequency="5" timeframe="30">
        <if_sid>83040</if_sid>
        <same_source_ip />
        <description>FTP: Eliminación masiva de archivos.</description>
    </rule>

</group>
